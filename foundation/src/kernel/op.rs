// @generated by uor-crate from uor-ontology â€” do not edit manually

//! `op/` namespace â€” Ring operations, involutions, algebraic identities, and the dihedral symmetry group D_{2^n} generated by neg and bnot..
//!
//! Space: Kernel

use crate::enums::GeometricCharacter;
use crate::Primitives;

/// An operation on the ring Z/(2^n)Z. The root class for all UOR kernel operations.
pub trait Operation<P: Primitives> {
    /// The number of arguments this operation takes. 1 for unary operations, 2 for binary operations.
    fn arity(&self) -> P::NonNegativeInteger;
    /// A description of the geometric role of this operation in the UOR ring and hypercube geometry. Examples: 'ring_reflection', 'hypercube_reflection', 'rotation', 'translation', 'scaling'.
    fn geometric_character(&self) -> GeometricCharacter;
    /// Associated type for `Operation`.
    type OperationTarget: Operation<P>;
    /// The inverse operation: the operation inv_op such that op(x, inv_op(x)) = e for all x, where e is the identity.
    fn inverse(&self) -> &Self::OperationTarget;
    /// Ordered list of operations this operation is composed from. Uses rdf:List to preserve application order (first element applied innermost). E.g., succ = neg âˆ˜ bnot is encoded as \[op:neg, op:bnot\] meaning neg applied to the result of bnot.
    fn composed_of(&self) -> &P::String;
}

/// A unary operation on the ring: takes one datum and produces one datum.
pub trait UnaryOp<P: Primitives>: Operation<P> {}

/// A binary operation on the ring: takes two datums and produces one datum.
pub trait BinaryOp<P: Primitives>: Operation<P> {
    /// Whether this binary operation satisfies op(x,y) = op(y,x) for all x, y in R_n.
    fn commutative(&self) -> P::Boolean;
    /// Whether this binary operation satisfies op(op(x,y),z) = op(x,op(y,z)) for all x, y, z in R_n.
    fn associative(&self) -> P::Boolean;
    /// The identity element of this binary operation: the value e such that op(x, e) = op(e, x) = x for all x in R_n.
    fn identity(&self) -> P::Integer;
}

/// A unary operation f such that f(f(x)) = x for all x in R_n. The two UOR involutions are neg (ring reflection) and bnot (hypercube reflection).
pub trait Involution<P: Primitives>: UnaryOp<P> {}

/// An algebraic identity: a statement that two expressions are equal for all inputs. The critical identity is neg(bnot(x)) = succ(x) for all x in R_n.
pub trait Identity<P: Primitives> {
    /// Associated type for `Operation`.
    type Operation: Operation<P>;
    /// The left-hand side operation of an algebraic identity.
    fn lhs(&self) -> &Self::Operation;
    /// The right-hand side operation of an algebraic identity.
    fn rhs(&self) -> &Self::Operation;
    /// The quantifier scope: the variable(s) over which this algebraic identity holds (e.g., 'x âˆˆ R_n').
    fn for_all(&self) -> &P::String;
}

/// A group: a set with an associative binary operation, an identity element, and inverses for every element.
pub trait Group<P: Primitives> {
    /// Associated type for `Operation`.
    type Operation: Operation<P>;
    /// An operation that generates this group. The dihedral group D_{2^n} is generated by op:neg and op:bnot.
    fn generated_by(&self) -> &[Self::Operation];
    /// The number of elements in the group. For D_{2^n}, the order is 2^(n+1).
    fn order(&self) -> P::PositiveInteger;
}

/// The dihedral group D_{2^n} of order 2^(n+1), generated by the ring reflection (neg) and the hypercube reflection (bnot). This group governs the symmetry of the UOR type space.
pub trait DihedralGroup<P: Primitives>: Group<P> {}

/// The foundational theorem of the UOR kernel: neg(bnot(x)) = succ(x) for all x in R_n. This identity links the two involutions (neg and bnot) to the successor operation, making succ derivable from neg and bnot.
pub mod critical_identity {
    /// `forAll`
    pub const FOR_ALL: &str = "x âˆˆ R_n";
    /// `lhs` -> `succ`
    pub const LHS: &str = "https://uor.foundation/op/succ";
    /// `rhs`
    pub const RHS: &[&str] = &[
        "https://uor.foundation/op/neg",
        "https://uor.foundation/op/bnot",
    ];
}

/// The dihedral group of order 2^(n+1), generated by neg (ring reflection) and bnot (hypercube reflection). Every element of this group acts as an isometry on the type space ð’¯_n.
pub mod d2n {
    /// `generatedBy`
    pub const GENERATED_BY: &[&str] = &[
        "https://uor.foundation/op/neg",
        "https://uor.foundation/op/bnot",
    ];
    /// `presentation`
    pub const PRESENTATION: &str = "âŸ¨r, s | r^{2^n} = sÂ² = e, srs = râ»Â¹âŸ©";
}

use crate::enums::PrimitiveOp;

impl PrimitiveOp {
    /// Returns the arity of this operation (1 for unary, 2 for binary).
    #[must_use]
    pub const fn arity(self) -> i64 {
        match self {
            Self::Neg => 1,
            Self::Bnot => 1,
            Self::Succ => 1,
            Self::Pred => 1,
            Self::Add => 2,
            Self::Sub => 2,
            Self::Mul => 2,
            Self::Xor => 2,
            Self::And => 2,
            Self::Or => 2,
        }
    }

    /// Returns whether this operation is commutative.
    #[must_use]
    pub const fn is_commutative(self) -> bool {
        false
    }

    /// Returns whether this operation is an involution (self-inverse).
    #[must_use]
    pub const fn is_involution(self) -> bool {
        false
    }

    /// Returns the geometric character of this operation.
    #[must_use]
    pub const fn geometric_character(self) -> crate::enums::GeometricCharacter {
        match self {
            Self::Neg => crate::enums::GeometricCharacter::RingReflection,
            Self::Bnot => crate::enums::GeometricCharacter::HypercubeReflection,
            Self::Succ => crate::enums::GeometricCharacter::Rotation,
            Self::Pred => crate::enums::GeometricCharacter::RotationInverse,
            Self::Add => crate::enums::GeometricCharacter::Translation,
            Self::Sub => crate::enums::GeometricCharacter::Translation,
            Self::Mul => crate::enums::GeometricCharacter::Scaling,
            Self::Xor => crate::enums::GeometricCharacter::HypercubeTranslation,
            Self::And => crate::enums::GeometricCharacter::HypercubeProjection,
            Self::Or => crate::enums::GeometricCharacter::HypercubeJoin,
        }
    }

    /// Returns true if this is a unary operation.
    #[must_use]
    pub const fn is_unary(self) -> bool {
        self.arity() == 1
    }

    /// Returns true if this is a binary operation.
    #[must_use]
    pub const fn is_binary(self) -> bool {
        self.arity() == 2
    }
}
